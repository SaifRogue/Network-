## 🧱 **Domain 4 – Network Security**

### 🎯 **مقدمة**

الدومين هذا يجمع بين **Network+** و **Security+**،  
يعني لما تدرسه صح، تكون قطعت مشوار كبير من الشهادتين مع بعض 🔥

هنا بنتعلم كيف نحمي الشبكة من أي تهديد، ونتعامل مع مفاهيم الأمان اللي دايم نسمع عنها مثل:

- **التشفير والتحقق والصلاحيات (Encryption, Authentication, Least Privilege)**
    
- **التحكم بالوصول Access Control & ACLs**
    
- **تقوية الأجهزة Device Hardening**
    
- **أدوات الحماية مثل NAC, VPNs, Firewalls, SIEM**
    
- **أنواع الهجمات وكيف تتجنبها**
    

---
---
---

## 🧱 **Security Concepts – 4.1**

### 🎯 **الهدف**

فهم المفاهيم الأساسية للأمان في الشبكات: التشفير، الشهادات، وإدارة الهوية والوصول (IAM).

---

### 🔹 **1. Logical Security – الأمان المنطقي**

#### 🧠 المفهوم:

حماية البيانات من الوصول غير المصرّح به **على مستوى البرمجيات أو المنظومة** (وليس المادي).

#### 🧩 العناصر:

|الجانب|الشرح|الهدف|
|---|---|---|
|**Encryption – التشفير**|تحويل البيانات إلى صيغة غير مفهومة لحمايتها من التجسس أو السرقة.|حماية الخصوصية وسرية البيانات.|
|• **Data in Transit**|البيانات أثناء انتقالها عبر الشبكة.|تُحمى ببروتوكولات مثل TLS / IPSec.|
|• **Data at Rest**|البيانات وهي مخزّنة على الأقراص أو الخوادم.|تُحمى بالتشفير الكامل للقرص (Full Disk Encryption).|

---

### 🔹 **2. Certificates – الشهادات الرقمية**

#### 🧠 المفهوم:

وسيلة لإثبات الهوية الرقمية وتأمين الاتصال بين الأنظمة.

#### 🧩 الأنواع:

|النوع|التعريف|الاستخدام|
|---|---|---|
|**PKI – Public Key Infrastructure**|منظومة لإدارة المفاتيح العامة والخاصة عبر شهادات رقمية موثوقة.|HTTPS, VPN, Email Encryption.|
|**Self-Signed Certificate**|شهادة موقّعة ذاتيًا بدون سلطة موثوقة (CA).|تُستخدم داخليًا أو للاختبار فقط.|

---

### 🔹 **3. Identity and Access Management (IAM)**

#### 🧠 المفهوم:

مجموعة عمليات للتحكم بمن يمكنه الدخول إلى الشبكة، وماذا يستطيع أن يفعل بعد دخوله.

#### 🧩 المكونات:

|العنصر|الشرح|أمثلة|
|---|---|---|
|**Authentication (المصادقة)**|التحقق من هوية المستخدم.|MFA, SSO, RADIUS, LDAP, SAML, TACACS+, Time-based.|
|**Authorization (التفويض)**|تحديد ما يُسمح للمستخدم بفعله بعد تسجيل الدخول.|Least Privilege, Role-Based Access Control (RBAC).|

---
## 🔐 **Authentication – المصادقة**

المقصود بالمصادقة هو **التحقق من هوية الشخص أو الجهاز** اللي يحاول يدخل الشبكة أو النظام.

---

### 🔹 **أنواع المصادقة الشائعة:**

|المصطلح|المعنى|مثال أو توضيح|
|---|---|---|
|**MFA – Multifactor Authentication**|التحقق باستخدام أكثر من عامل (كلمة مرور + بصمة مثلًا).|Login يحتاج Password + Code من الهاتف.|
|**SSO – Single Sign-On**|تسجيل دخول واحد يسمح بالوصول لعدة أنظمة.|تدخل بحسابك الجامعي أو الوظيفي مرة واحدة وتفتح كل التطبيقات.|
|**RADIUS – Remote Authentication Dial-In User Service**|خادم مركزي للمصادقة على المستخدمين البعيدين.|يُستخدم في VPNs أو شبكات الشركات للتحقق من الهوية قبل الدخول.|
|**LDAP – Lightweight Directory Access Protocol**|بروتوكول لإدارة المستخدمين داخل الشبكة وتخزين بياناتهم.|يُستخدم مع Active Directory لتنظيم صلاحيات الدخول.|
|**SAML – Security Assertion Markup Language**|طريقة تبادل بيانات تسجيل الدخول بين مواقع أو أنظمة مختلفة بشكل آمن.|لما تدخل على موقع ويقول لك “سجّل الدخول عبر Google”.|
|**TACACS+ – Terminal Access Controller Access Control System Plus**|بروتوكول مصادقة يستخدمه عادةً مسؤولو الشبكات للوصول إلى أجهزة الشبكة.|يعطي تحكم دقيق في صلاحيات أوامر المستخدمين على الراوتر والسويتش.|
|**Time-based Authentication**|يعتمد على رمز مؤقت يتغير كل فترة (عادة كل 30 ثانية).|تطبيقات مثل Google Authenticator أو Microsoft Authenticator.|

---

### 💡 **الفكرة العامة:**

كل الأنظمة السابقة تهدف إلى نفس الشيء:

> "تأكد أن اللي يدخل هو فعلاً الشخص المصرّح له، وبالطريقة الصحيحة."

---
## 🧱 **Authorization – التفويض**

بعد ما يتم التحقق من هوية المستخدم (Authentication)، تبدأ مرحلة **Authorization**،  
وهي تحديد **وش يقدر يسوي** داخل النظام بعد تسجيل الدخول.

---

### 🔹 **أنواع التفويض وأساليبه**

|المفهوم|المعنى|مثال عملي|
|---|---|---|
|**Least Privilege – أقل صلاحية ممكنة**|إعطاء المستخدم أقل صلاحيات يحتاجها لإنجاز عمله فقط.|موظف الدعم الفني يقدر يشوف إعدادات السيرفر لكن ما يقدر يغيّرها.|
|**RBAC – Role-Based Access Control**|تحديد الصلاحيات بناءً على **الدور أو الوظيفة**، مو على كل مستخدم لوحده.|كل موظفي قسم المالية لهم نفس صلاحيات الوصول للأنظمة المالية.|
|**Geofencing – التحديد الجغرافي**|تقييد الوصول حسب الموقع الجغرافي.|دخول مسموح فقط من داخل مبنى الشركة أو من IP معيّن.|

---

### 💡 **الفكرة العامة**

التفويض = “وش مسموح لك بعد ما تدخل”.  
هو الخطوة الثانية بعد المصادقة، واللي من دونها ممكن المستخدم يكون مصدَّق لكنه يسبب ضرر بسبب صلاحيات زائدة.

---

## 🧱 **Physical Security – الأمان المادي**

بينما الأمان المنطقي يحمي البيانات على مستوى الشبكة،  
الأمان المادي يحمي الأجهزة نفسها من الوصول أو العبث.

|العنصر|الوصف|الهدف|
|---|---|---|
|**Camera – الكاميرات**|تراقب الدخول والخروج وتسجّل الأحداث.|الردع والمراقبة في حال وقوع اختراق مادي.|
|**Locks – الأقفال**|حماية غرف السيرفرات والمعدات.|منع الوصول الفعلي غير المصرّح به.|

---

### 🎯 **الربط بين الأمان المنطقي والمادي**

الاثنين يكملون بعض:

- **المنطقي (Logical)** يمنع الاختراق عن بُعد.
    
- **المادي (Physical)** يمنع التلاعب داخل المكان نفسه.
---


## 🔐 **AAA Framework – التعريف والمكونات**

إطار **AAA** يُستخدم في الشبكات للتحكم في **الوصول** (Access Control)  
وهو اختصار لـ **Authentication, Authorization, Accounting** — وأحيانًا يُضاف قبله مفهوم **Identification**.

---

### 🔹 **1. Identification – التعرّف**

- هي المرحلة اللي المستخدم يعلن فيها “من هو”.
    
- غالبًا تكون **اسم المستخدم (Username)**.
    

> 🗝️ مثال: لما تكتب اسمك في شاشة تسجيل الدخول.

---

### 🔹 **2. Authentication – المصادقة**

- التحقق من إنك فعلًا الشخص اللي تقول عنه.
    
- تستخدم **كلمة المرور أو العوامل المتعددة (MFA)**.
    

> 🧩 مثال: إدخال كلمة السر، أو كود مؤقت من الهاتف.

---

### 🔹 **3. Authorization – التفويض**

- بعد التحقق من هويتك، النظام يحدد وش الصلاحيات المسموحة لك.
    

> 🔑 مثال: موظف الدعم الفني يقدر يدخل لوحة التحكم، لكن ما يقدر يعدّل الإعدادات الأساسية.

---

### 🔹 **4. Accounting – المحاسبة (التتبع)**

- تسجيل كل نشاط داخل النظام لمتابعة الاستخدام أو التحقيق في الحوادث.
    

> 📋 يشمل: وقت الدخول والخروج، كمية البيانات المرسلة، الأوامر المنفذة.

---

### 💡 **الفكرة العامة:**

|المرحلة|السؤال الأساسي|الهدف|
|---|---|---|
|**Identification**|من أنت؟|تحديد الهوية|
|**Authentication**|أثبت أنك من تقول أنك هو|التحقق من الهوية|
|**Authorization**|ماذا يُسمح لك أن تفعل؟|إدارة الصلاحيات|
|**Accounting**|ماذا فعلت؟ ومتى؟|التتبع والتدقيق|


---



## 🧱 **ما هو X.500؟**

**X.500** هو **معيار قديم من ITU (الاتحاد الدولي للاتصالات)** وُضع في الثمانينات،  
هدفه كان إنشاء **دليل (Directory)** ضخم للمؤسسات حول العالم — مثل دفتر هاتف عالمي لكن لأنظمة الحاسب.

الفكرة:

> كل مستخدم أو جهاز أو خدمة في الشبكة يكون له "بطاقة تعريف" داخل هذا الدليل.

---

## 🧩 **العلاقة بين X.500 و LDAP**

مع مرور الوقت، طلعوا المبرمجين وقالوا:

> “X.500 معقد جدًا وبروتوكوله ثقيل، نبي شيء أبسط.”

فتم إنشاء **LDAP (Lightweight Directory Access Protocol)**،  
وهو نسخة أخف وأبسط من **X.500**، لكنه مبني على نفس المفهوم تقريبًا.

يعني:

- **X.500** هو الأصل (الفكرة الكاملة).
    
- **LDAP** هو التطبيق العملي الحديث منها.
    

---

## 📂 **كيف تُستخدم الفكرة في الواقع؟**

- في الشبكات اليوم، لما تستخدم **Active Directory** في ويندوز (AD DS)،  
    فهي في الحقيقة **تستخدم LDAP** — اللي يعتمد على نموذج **X.500** في ترتيب البيانات.
    
- النظام ينظم المستخدمين والمجموعات والأجهزة داخل شجرة اسمها **Directory Information Tree (DIT)**.
    

---

## 🌳 **مثال توضيحي**

في X.500 (و LDAP) كل كائن يُسمى **Entry** وله “مسار” يسمّى **Distinguished Name (DN)**.

مثلاً:

`CN=Saif Alotaibi, OU=Students, O=TuwaiqAcademy, C=SA`

وتفصيلها:

|الرمز|المعنى|
|---|---|
|**CN**|Common Name (اسم المستخدم أو العنصر)|
|**OU**|Organizational Unit (القسم أو الوحدة)|
|**O**|Organization (المنظمة أو الشركة)|
|**C**|Country (الدولة)|

---

## 🔐 **الخلاصة:**

|المفهوم|التعريف|الاستخدام اليوم|
|---|---|---|
|**X.500**|معيار أصلي لإنشاء أدلة شبكية منظمة|الأساس النظري|
|**LDAP**|النسخة الخفيفة والمستخدمة فعليًا من X.500|Active Directory, RADIUS, IAM systems|
|**Active Directory**|تطبيق فعلي لـ LDAP/X.500 داخل شبكات ويندوز|إدارة المستخدمين والصلاحيات|

---


## ⚠️ ملاحظة مهمة

> هذه الفقرة تشرح تقنيات خداع يُستخدمها المدافعون لجذب المهاجمين ومراقبة سلوكهم.  
> مهم تفهمها عشان تعرف كيف تُنشئ فخّ فعال أو تكتشف متى الهدف قد يكون مزيفًا.

---

## 🧠 **Deception Technologies – تقنيات الخداع**

هي أدوات تُستخدم لاكتشاف المهاجمين عن طريق “خداعهم” بأنهم اخترقوا شيئًا حقيقيًا، بينما في الواقع كل شيء تحت المراقبة.

|المصطلح|الوصف|الهدف|
|---|---|---|
|**Honeypot**|نظام أو خادم مزيف يُترك عمدًا مكشوفًا ليجذب المهاجم.|مراقبة أساليب المهاجمين وجمع معلومات عنهم.|
|**Honeynet**|شبكة كاملة من عدة honeypots متصلة ببعضها.|محاكاة بيئة حقيقية لجمع بيانات أعمق عن سلوك الهجمات.|

🎯 **الفكرة:** تخلي الهاكر يظن إنه اخترق شبكة حقيقية، بينما هو في فخّ مراقَب بدقة.

---

## 📚 **Common Security Terminology – المصطلحات الأمنية الأساسية**

|المصطلح|المعنى المبسّط|مثال|
|---|---|---|
|**Risk (الخطر)**|احتمال وقوع شيء يضر بالنظام.|فقدان بيانات أو انقطاع خدمة.|
|**Vulnerability (ثغرة)**|نقطة ضعف في النظام يمكن استغلالها.|برنامج غير محدّث.|
|**Exploit (الاستغلال)**|الأداة أو الطريقة اللي يستخدمها المهاجم لاستغلال الثغرة.|سكربت يخترق خادمًا غير محمي.|
|**Threat (التهديد)**|أي حدث محتمل يمكن أن يسبب ضررًا.|هجوم DDoS أو فيروسات.|

---

## 🔺 **CIA Triad – مثلث الأمان الأساسي**

|العنصر|المعنى|الهدف|
|---|---|---|
|**Confidentiality (السرية)**|حماية البيانات من الوصول غير المصرّح به.|التشفير + IAM.|
|**Integrity (السلامة)**|التأكد أن البيانات لم تتغير أو تتلف.|الـ Hashing + Checksums.|
|**Availability (التوافرية)**|ضمان أن النظام والبيانات دائمًا متاحة.|النسخ الاحتياطي + UPS + DR.|

💡 **ملخص:**  
“CIA” = السرية، السلامة، والتوافرية.

---

## 🧾 **Audits and Regulatory Compliance – التدقيق والامتثال التنظيمي**

### 🎯 **الهدف**

ضمان أن الشبكة وأنظمتها تلتزم بالقوانين والمعايير الدولية لحماية البيانات والخصوصية،  
وأن المؤسسة قادرة على إثبات التزامها عبر عمليات تدقيق رسمية (Audits).

---

### 🔹 **Data Locality – موقع البيانات**

- يقصد بها **أين يتم تخزين ومعالجة البيانات فعليًا** (في أي دولة أو مركز بيانات).
    
- بعض القوانين تشترط أن تبقى بيانات المواطنين داخل حدود دولتهم.
    

> 📍 مثال: شركة أوروبية لا يجوز أن تخزن بيانات عملائها في خوادم خارج الاتحاد الأوروبي إلا بضوابط محددة.

- في الشبكات السحابية (Cloud)، مهم جدًا تحديد الموقع الجغرافي للسيرفرات لحماية الخصوصية والامتثال القانوني.
    

---

### 🔹 **PCI DSS – Payment Card Industry Data Security Standard**

- معيار أمني عالمي يخص حماية بيانات **بطاقات الدفع (Visa, MasterCard, ...)**.
    
- يُلزم أي مؤسسة تتعامل مع بيانات بطاقات الائتمان بتطبيق إجراءات صارمة مثل:
    
    - التشفير أثناء النقل والتخزين.
        
    - مراقبة الدخول وسجلات العمليات.
        
    - الحد من الوصول إلى البيانات الحساسة.
        

> 💳 يطبق على المتاجر الإلكترونية، البنوك، مزودي الدفع، ومراكز البيانات المالية.

---

### 🔹 **GDPR – General Data Protection Regulation**

- نظام حماية البيانات الأوروبي (الاتحاد الأوروبي).
    
- يحدد **حقوق الأفراد** في التحكم ببياناتهم الشخصية، ويلزم المؤسسات بـ:
    
    - الحصول على **موافقة صريحة** قبل جمع البيانات.
        
    - توفير وسيلة لحذف البيانات عند الطلب ("Right to be forgotten").
        
    - الإبلاغ عن أي خرق أمني خلال 72 ساعة.
        

> 🇪🇺 تطبيقه عالمي: حتى الشركات خارج أوروبا يجب أن تلتزم به إذا تتعامل مع بيانات مستخدمين أوروبيين.

---

### 💡 **خلاصة سريعة**

|المصطلح|المعنى|الأهمية في الشبكات|
|---|---|---|
|**Data Locality**|تحديد موقع تخزين البيانات|لتجنب خرق قوانين الخصوصية|
|**PCI DSS**|معيار لحماية بيانات بطاقات الدفع|لتأمين المعاملات الإلكترونية|
|**GDPR**|قانون أوروبي لحماية الخصوصية|لضمان موافقة المستخدمين وحماية بياناتهم|

---


---

## 🧱 **Network Segmentation Enforcement – تطبيق تقسيم الشبكة**

### 🎯 **الفكرة العامة**

هي عملية **تجزئة الشبكة إلى أقسام (Segments)** مستقلة بحيث لا يستطيع المهاجم أو الفيروس الانتشار بسهولة بين الأجهزة،  
والهدف هو **التحكم في حركة المرور (Traffic Control)** وتقليل مساحة الهجوم.

|العنصر|المعنى|الهدف|
|---|---|---|
|**Network Segmentation**|تقسيم الشبكة إلى شبكات فرعية صغيرة (مثل VLANs).|الحد من الانتشار، حماية الأنظمة الحساسة.|
|**Enforcement**|تطبيق فعلي لهذه السياسة عبر الجدران النارية أو القواعد الأمنية.|ضمان أن كل قسم يتواصل فقط مع ما هو مسموح له.|

---

## 🌐 **IoT / IIoT – إنترنت الأشياء الصناعي والعام**

|المصطلح|التعريف|التحدي الأمني|
|---|---|---|
|**IoT (Internet of Things)**|أجهزة ذكية منزلية مثل الكاميرات والمستشعرات.|عادةً لا تحتوي على حماية قوية.|
|**IIoT (Industrial IoT)**|أنظمة صناعية ذكية في المصانع والبنية التحتية.|تتصل بأنظمة حساسة قد تُسبب كوارث لو تم اختراقها.|

> ⚠️ ملاحظة: يجب عزل أجهزة الـ IoT و الـ IIoT في شبكات خاصة بها لتجنّب الوصول إلى الأنظمة الداخلية.

---

## ⚙️ **SCADA / ICS / OT – أنظمة التحكم الصناعي**

|المصطلح|المعنى|أمثلة|
|---|---|---|
|**SCADA (Supervisory Control and Data Acquisition)**|أنظمة مراقبة وتحكم عن بُعد تُستخدم في الطاقة والمياه والمصانع.|محطات الكهرباء، خطوط النفط.|
|**ICS (Industrial Control System)**|الأنظمة الميدانية التي تتحكم بالمعدات فعليًا.|وحدات التحكم (PLCs).|
|**OT (Operational Technology)**|أي تقنية تُستخدم لتشغيل معدات مادية.|الروبوتات، المستشعرات، خطوط الإنتاج.|

> 🧩 عادة تُفصل هذه الأنظمة عن الإنترنت تمامًا أو تُربط عبر شبكات محمية بشكل صارم.

---

## 👥 **Guest Network – شبكة الضيوف**

- شبكة منفصلة تُستخدم لتوصيل الأجهزة الزائرة دون السماح لها بالوصول إلى الأنظمة الداخلية.
    
- تُطبّق غالبًا في الشركات والمطارات والمدارس.
    

> 🔐 تُستخدم تقنيات مثل **Captive Portal** (صفحة تسجيل دخول) لضبط الوصول.

---

## 💼 **BYOD – Bring Your Own Device**

- سياسة تسمح للموظفين باستخدام أجهزتهم الشخصية في العمل.
    
- تحتاج إلى ضوابط مثل:
    
    - **Network Access Control (NAC)**
        
    - **VPN / MDM** (إدارة الأجهزة المحمولة)
        
    - **عزل حركة الأجهزة الشخصية** عن بيانات الشركة.
        

---

### 💡 **خلاصة سريعة**

|المصطلح|الهدف الأمني|
|---|---|
|**Segmentation**|منع الانتشار الداخلي للهجمات.|
|**IoT / IIoT**|فصل الأجهزة الذكية الضعيفة عن الشبكات الحرجة.|
|**SCADA / ICS / OT**|حماية الأنظمة الصناعية من الاختراق.|
|**Guest**|إعطاء وصول محدود وآمن للضيوف.|
|**BYOD**|السماح باستخدام الأجهزة الشخصية دون تعريض الشبكة للخطر.|

---
---
---

# 4.2


## 💣 **Denial of Service (DoS) / DDoS – هجمات حجب الخدمة**

### 🎯 **الفكرة العامة**

هجوم يهدف إلى **تعطيل خدمة أو جعلها غير متاحة** للمستخدمين الشرعيين عن طريق:

- **إغراق الخوادم بالطلبات.**
    
- **استغلال ثغرة تصميم أو ضعف في النظام.**
    

---

### 🔹 **أنواع هجمات DoS**

|النوع|الوصف|مثال|
|---|---|---|
|**DoS (الأساسي)**|مهاجم واحد يهاجم نظامًا واحدًا.|إغراق موقع بطلبات HTTP كثيرة.|
|**DDoS (الموزّع)**|عدة أجهزة (Botnet) تهاجم نفس الهدف في وقت واحد.|آلاف الأجهزة المصابة ترسل ترافيك نحو خادم واحد.|

---

### ⚙️ **أهداف المهاجم**

- **إجبار الخدمة على الفشل** (Overload).
    
- **استغلال ثغرة تصميم** لجعل النظام يتعطل.
    
- **خلق فوضى أو تشويش (Smokescreen)** لإخفاء هجوم آخر (مثل DNS Spoofing).
    
- **اكتساب ميزة تنافسية** (تعطيل موقع منافس).
    
- **أحيانًا تكون بسيطة جدًا**: مثل فصل الكهرباء أو قطع الكابل.
    

---

### 🔸 **Friendly DoS – حجب الخدمة غير المقصود**

مو دائمًا الهجوم متعمّد، بعض الأعطال تكون “DoS ودي” بدون نية خبيثة:

|النوع|الوصف|
|---|---|
|**Unintentional DoS**|ضغط كبير ناتج عن تحديث أو حمل زائد من المستخدمين.|
|**Network DoS**|حدوث Loop في Layer 2 لعدم وجود STP.|
|**Bandwidth DoS**|تحميل ملفات ضخمة على خط بطيء يستهلك الباندويث.|

---

## 🌍 **DDoS – Distributed Denial of Service**

|المفهوم|الشرح|
|---|---|
|**Botnet**|شبكة ضخمة من الأجهزة المصابة تُدار عن بُعد لتنفيذ الهجوم.|
|**هدف الهجوم**|استنزاف عرض النطاق (Bandwidth) أو موارد الخادم (CPU/RAM).|
|**ميزة غير متكافئة (Asymmetric Threat)**|أحيانًا المهاجم يمتلك موارد أقل بكثير من الضحية لكنه يسبب ضررًا كبيرًا بذكاء.|

> 🧩 مثال:  
> **Zeus Botnet** في ذروته كان يتحكم في أكثر من **3.6 مليون جهاز** لإطلاق هجمات منسقة.

---

## 🚀 **DDoS Reflection & Amplification – مضاعفة الهجوم**

- فكرة الهجوم: **تحويل هجوم صغير إلى كبير جدًا** عبر استخدام خدمات الإنترنت ضد الضحية.
    
- يتم “عكس” (Reflect) الطلب على خوادم وسيطة (مثل DNS أو NTP) بحيث ترد هذه الخوادم على الهدف بدل المهاجم.
    
- يتم “تضخيم” (Amplify) النتيجة لأن الرد يكون أكبر بكثير من الطلب الأصلي.
    

|العنصر|الوصف|
|---|---|
|**Reflection**|المهاجم يرسل طلبات مزيفة تظهر وكأنها من الضحية.|
|**Amplification**|استغلال بروتوكولات تُرجع ردًا أكبر من الطلب (DNS, NTP, ICMP).|
|**النتيجة**|خوادم عادية تُغرق الهدف بالردود، بدون ما تعرف إنها جزء من الهجوم.|

---

### 💡 **نصائح الحماية**

- استخدم **Firewalls وRate Limiting**.
    
- فعّل **Anti-DDoS Protection** من مزود الخدمة.
    
- حدّث الأنظمة لتجنّب الثغرات القابلة للاستغلال.
    
- راقب الـ **Traffic patterns** لاكتشاف أي زيادة غير طبيعية.

---


## **VLAN Hopping – 4.2**

### 🎯 **الفكرة العامة**

هجوم يسمح للمهاجم بالانتقال من VLAN إلى أخرى (hop) بدون صلاحية.  
الهدف عادة الوصول لشبكات داخلية أو تنفيذ هجوم DoS.  
هناك **طريقتان رئيسيتان**:

---

### 🔹 **1. Switch Spoofing**

المهاجم يجعل جهازه يتصرف كأنه **switch** ويتفاوض على **trunk** باستخدام بروتوكول DTP.  
إذا نجح، يحصل على وصول لعدة VLANs من خلال نفس المنفذ.

#### 🛡️ **الحماية:**

- عطّل **DTP** على الواجهات:
    
	switchport mode access  
	switchport nonegotiate
	
	
- اجعل المنافذ **access** إلا إذا كانت فعلاً بحاجة إلى **trunk**.
    
- حدد الـ **allowed VLANs** على المنافذ الـ trunk فقط.
    

---

### 🔹 **2. Double Tagging**

المهاجم يرسل حزمة تحتوي على **تاقين 802.1Q** (outer + inner tag).

- السويتش الأول يزيل الـ _outer tag_ (الـ native VLAN).
    
- السويتش الثاني يقرأ الـ _inner tag_ ويرسلها إلى VLAN أخرى.
    

> ⚠️ هذا النوع غالبًا **اتجاه واحد** — الرد لا يرجع للمصدر (يُستخدم لهجمات DoS أو تسريب بيانات محدودة).

#### 🛡️ **الحماية:**

- لا تضع أجهزة على **native VLAN**.
    
- غيّر رقم **native VLAN** الافتراضي (عادة 1).
    
- فعّل **forced tagging** للـ native VLAN إن توفر الخيار.
    
- حدد VLANs المسموح بها على المنافذ الـ trunk.
    

---

### 🧱 **أفضل الممارسات العامة**

- تعطيل تفاوض الـ trunk (DTP) في كل المنافذ.
    
- تفعيل **Port Security** (تحديد عدد الماك، قفل المنافذ الزائدة).
    
- استخدام **Management VLAN** منفصل عن الـ native VLAN.
    
- تفعيل ميزات الحماية: **BPDU Guard**، **Root Guard**.
    
- مراقبة الـ logs والتنبيه لأي تغيير في حالة المنافذ (access ↔ trunk).
    

---

### 💡 **ملخص سريع للاختبار**

| المصطلح             | الشرح                                                  | الوقاية                                    |
| ------------------- | ------------------------------------------------------ | ------------------------------------------ |
| **Switch Spoofing** | استغلال تفاوض trunk (DTP).                             | اجعل المنافذ access وعطّل DTP.             |
| **Double Tagging**  | استغلال native VLAN وتاغين في الحزمة.                  | غيّر الـ native VLAN وفعّل tagging إجباري. |
| **أفضل دفاع**       | لا تضع أجهزة على الـ native VLAN ولا تترك trunk مفتوح. | ✅                                          |


---

## **MAC Flooding – 4.2**

### 🎯 الفكرة العامة

**MAC Flooding** هجوم يهدف لملء جدول الـ CAM (جدول عناوين MAC) في السويتش بمداخل مزيفة، فتنجح بإجبار السويتش على التحول لسلوك أشبه بالـ _hub_ — يعني يغرّق الفِرم (flood) الترافيك لكل البورتات بدل ما يوجهه للماك الصحيح، فيصير التنصّت (sniffing) أسهل للمهاجم.

---

### 🔹 كيف يصير الهجوم؟

- المهاجم يرسل آلاف/ملايين إطارات (frames) تحتوي على عناوين MAC عشوائية عبر منفذ واحد أو عدة منافذ.
    
- جدول CAM (MAC address table) يمتلئ لأن السويتش يحاول تخزين كل MAC جديد.
    
- عند امتلاء الجدول، السويتش يبدأ يـ**flood** الترافيك لِكل المنافذ بدلاً من توجيهه إلى المنفذ الصحيح.
    

---

### ◼️ لماذا هذا خطر؟

- يفتح باب **التنصّت** على الترافيك الداخلي (sensitive traffic).
    
- قد يؤدي إلى **انقطاع خدمات** أو تسريب بيانات.
    
- يُستغل أحيانًا كتمهيد لهجمات أُخرى (مثل ARP spoofing أو سرقة جلسات).
    

---

### ⚙️ علامات الاكتشاف

- زيادة مفاجئة في عدد الماكات المعلَنة في جدول CAM.
    
- ارتفاع مفاجئ في الترافيك المفلود على منافذ لا تحتوي أجهزة نشطة.
    
- تقارير من المستخدمين عن بطء أو فقدان حزم.
    
- سجلات السويتش تُظهر محاولات تعلم ماكات بكثرة.
    

---

### 🛡️ كيف تحمي الشبكة (أفضل الممارسات)

- **Port Security (أهم إجراء):** قيّد عدد عناوين MAC المسموح بها لكل بورت، واستخدم سياسات حظر/إغلاق عند التعدي.  
    أمثلة أوامر Cisco IOS:
    
                                interface fa0/5
	                     switchport mode access
	                    switchport port-security
	            switchport port-security maximum 2
	switchport port-security violation shutdown
	switchport port-security mac-address sticky
	
    
    
- **Static MAC bindings:** اربط الماكات الحرجة (servers، APs) بشكل ثابت لمنع تغيّرها.
    
- **Disable unused ports** واغلقها (`shutdown`) أو ضعهم في VLAN مخصصة ومراقبة.
    
- **Storm control / broadcast limiting:** تحد من كمية البث/متعدد الإرسال على البورت.
    
- **Network segmentation / private VLANs:** تقليل تأثير الفلوود على أجزاء الشبكة الحرجة.
    
- **802.1X / NAC:** مصادقة على مستوى البورت قبل السماح لأي جهاز.
    
- **مراقبة مستمرة (Monitoring):** راقب جدول CAM، SNMP traps، وسياسات التنبيه في الـ SIEM.
    

---

### 🔍 ملاحظة - الفرق بين MAC Flooding و MAC Spoofing

- **MAC Flooding:** هجوم يهدف لملء جدول MAC ليجعل السويتش يفلود الترافيك.
    
- **MAC Spoofing:** مهاجم يغيّر عنوان MAC جهازه ليقلد جهاز آخر (مثلاً لتجاوز القيود أو لسرقة جلسة).  
    كلاهما خطر، لكن آليات الدفاع قد تختلف (port-security مفيد جداً للحالتين).
    

---

### 💡 نقاط مهمة للاختبار

- MAC Flooding يؤدي إلى **flooding** traffic عندما يمتلئ جدول CAM.
    
- **Port security** هو الحل الشائع والأهم لمواجهة MAC Flooding.
    
- تعطيل البورتات غير المستخدمة، وتحديد أقصى عدد MAC لكل بورت، وربط الماكات الحساسة بشكل ثابت — كلها من أساليب الحماية المطلوبة.

---


